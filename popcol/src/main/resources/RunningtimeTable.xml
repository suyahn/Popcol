<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="runningtimetablens">
	<resultMap id="runningtimetableResult" type="runningtimetable">
		<result property="rtid" column="rtid" />
		<result property="lid" column="lid" />
		<result property="tid" column="tid" />
		<result property="mid" column="mid" />
		<result property="rtdate" column="rtdate" />
		<result property="rttime" column="rttime"/>
		<result property="timezone" column="timezone"/>
		<result property="tname" column="tname"/>
	</resultMap>

	<!-- <select id="bookingRTList" resultMap="runningtimetableResult"
		parameterType="hashMap">
		  select distinct to_date (to_char(rtdate,'rr/mm/dd'),'rr/mm/dd') rtdate 
		from runningtimetable where mid=#{mid} and lid=#{lid} group by rtdate</select> -->
	<select id="bookingRttList" resultMap="runningtimetableResult" parameterType="hashMap">
		<!-- select rtid, rtdate, to_char(rtdate,'HH24:mi') rttime from
		runningtimetable where rtid = #{rtid} -->
		select rt.*, to_char(rtdate, 'HH24"시" MI"분"') rttime, tname from runningtimetable rt, theater t 
    	where mid = #{mid} and rt.lid = #{lid} and t.tid = rt.tid
	</select>
	<select id="bookingrtList" parameterType="int" resultType="runningtimetable">
	    select rt.*, to_char(rtdate, 'HH24:MI') rttime, m.mtitle, l.lname, t.tname 
	    from movie m, location l, runningtimetable rt, theater t
	    where  rt.lid = l.lid and rt.mid=m.mid and rt.tid = t.tid
	    and rtdate = (select rtdate from runningtimetable
		where rtid = #{rtid})
	</select>
	<select id="runningtimeTableList" resultMap="runningtimetableResult">
		select * from runningtimetable
	</select>

</mapper>